<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4times6 Mono Playground</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        /* 1. 폰트 파일 연결 (업로드한 파일명과 정확히 일치해야 함) */
        @font-face {
            font-family: 'MonoThin';
            src: url('4times6mono-Thin-COLR.ttf') format('truetype');
        }
        @font-face {
            font-family: 'MonoRegular';
            src: url('4times6mono-Regular-COLR.ttf') format('truetype');
        }
        @font-face {
            font-family: 'MonoBold';
            src: url('4times6mono-Bold-SVG.ttf') format('truetype');
        }
        @font-face {
            font-family: 'MonoColor';
            src: url('4times6mono-COLOR-SVG.ttf') format('truetype');
            /* 컬러 폰트 활성화 옵션 */
            font-feature-settings: "calt" 1, "liga" 1, "clig" 1;
        }

        /* 2. 전체 페이지 스타일 */
        body {
            background-color: white; /* 배경 흰색 */
            color: black;
            font-family: 'MonoRegular', monospace; /* 기본 폰트 */
            overflow: hidden;
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* 3. 에디터 영역 */
        #editor {
            flex-grow: 1;
            width: 100%;
            height: 100%;
            padding: 40px;
            box-sizing: border-box;
            outline: none;
            
            font-size: 30pt; /* 30pt 고정 */
            line-height: 1.4;
            white-space: pre-wrap;
            word-break: break-all;
            overflow-y: auto;
        }

        /* 미리보기 텍스트 */
        #editor:empty:before {
            content: 'try typing 4times6 mono';
            color: black;
            opacity: 1;
            pointer-events: none;
        }

        /* 4. 하단 플로팅 컨트롤 박스 */
        .control-box {
            position: fixed;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            
            width: 300px;
            background-color: white;
            padding: 20px 25px;
            
            /* [요청하신 디자인] 네 변의 색이 다른 2pt 테두리 */
            border-top: 2px solid #FF623E;
            border-right: 2px solid #3C8E77;
            border-bottom: 2px solid #AE62B7;
            border-left: 2px solid #746832;
            
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            z-index: 100;
        }

        /* 현재 폰트 이름 표시 (Color 폰트로 표시) */
        #font-label {
            font-family: 'MonoColor', monospace;
            font-size: 24px;
            text-align: center;
            margin-bottom: 5px;
        }

        /* 5. 슬라이더 스타일 */
        input[type=range] {
            -webkit-appearance: none; 
            width: 100%; 
            background: transparent; 
        }

        /* 슬라이더 바 (Track) - #FFA31D */
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 2px;
            cursor: pointer;
            background: #FFA31D;
            border: none;
        }

        /* 슬라이더 버튼 (Thumb) - 동적 색상 변경 + 검정 테두리 */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: var(--thumb-color, #FFFA2D); /* JS에서 변경됨 */
            border: 1px solid black; /* 검은색 1pt 테두리 */
            cursor: pointer;
            margin-top: -9px; /* 중앙 정렬 */
        }

        /* 파이어폭스 지원 */
        input[type=range]::-moz-range-track {
            width: 100%; height: 2px; background: #FFA31D; cursor: pointer;
        }
        input[type=range]::-moz-range-thumb {
            height: 20px; width: 20px; border: 1px solid black;
            border-radius: 50%; background: var(--thumb-color, #FFFA2D); cursor: pointer;
        }
    </style>
</head>
<body>

    <div id="editor" contenteditable="true" spellcheck="false"></div>

    <div class="control-box">
        <!-- 현재 단계 텍스트 (Color 폰트) -->
        <div id="font-label">Regular</div>
        
        <!-- 4단계 슬라이더 -->
        <input type="range" id="font-slider" min="0" max="3" value="1" step="1">
    </div>

    <script>
        const editor = document.getElementById('editor');
        const slider = document.getElementById('font-slider');
        const label = document.getElementById('font-label');
        
        // [설정] 단계별 정보 (이름, 폰트패밀리, 버튼 색상)
        const steps = [
            { name: 'Thin',    family: 'MonoThin',    color: '#72AF2D' },
            { name: 'Regular', family: 'MonoRegular', color: '#FFFA2D' },
            { name: 'Bold',    family: 'MonoBold',    color: '#EF3F54' },
            { name: 'Color',   family: 'MonoColor',   color: '#34A5D6' }
        ];

        function updateFont() {
            const index = parseInt(slider.value);
            const currentStep = steps[index];

            // 1. 에디터 폰트 변경
            editor.style.fontFamily = currentStep.family;
            
            // 2. 라벨 텍스트 변경 (라벨은 항상 Color 폰트 유지)
            label.textContent = currentStep.name;
            
            // 3. 슬라이더 버튼 색상 변경
            slider.style.setProperty('--thumb-color', currentStep.color);
        }

        // [글자 깨짐 방지] 영문/숫자/기호 외에는 하트(♥)로 변환
        function filterInput(e) {
            // 한글 조합 중일 때는 간섭하지 않음 (단, 이 폰트는 한글이 없으므로 입력 완료 후 변환됨)
            if (e.type === 'compositionstart') return;

            const selection = window.getSelection();
            if (!selection.rangeCount) return;
            const node = selection.focusNode;

            if (node.nodeType === 3) { // 텍스트 노드일 때
                const text = node.nodeValue;
                // 허용: 영어 대소문자, 숫자, 공백, 기본 특수문자
                // 차단: 한글 등 그 외 모든 문자 -> ♥ (U+2665)
                const regex = /[^a-zA-Z0-9\s`~!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/g;

                if (regex.test(text)) {
                    const range = selection.getRangeAt(0);
                    const offset = range.startOffset;

                    // 변환
                    const newText = text.replace(regex, '♥');
                    node.nodeValue = newText;

                    // 커서 위치 복구
                    try {
                        const newRange = document.createRange();
                        newRange.setStart(node, Math.min(offset, newText.length));
                        newRange.setEnd(node, Math.min(offset, newText.length));
                        selection.removeAllRanges();
                        selection.addRange(newRange);
                    } catch (err) {}
                }
            }
        }

        // 이벤트 연결
        slider.addEventListener('input', updateFont);
        editor.addEventListener('input', filterInput);
        
        // 붙여넣기 시 필터링
        editor.addEventListener('paste', (e) => {
            e.preventDefault();
            let text = (e.originalEvent || e).clipboardData.getData('text/plain');
            text = text.replace(/[^a-zA-Z0-9\s`~!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/g, '♥');
            document.execCommand('insertText', false, text);
        });

        // 초기화
        updateFont();
        editor.focus();
    </script>
</body>
</html>
